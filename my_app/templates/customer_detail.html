{% extends 'layouts/base.html' %}
{% load i18n %}

{% block title %}{{ customer.name }} - {% trans "Customer" %}{% endblock %}

{% block content %}

{% block page_name %}{{ customer.name }}{% endblock %}

<div class="row justify-content-center">
  <div class="col-lg-10 col-md-12">
    <div class="card mb-4">
      <div class="card-header d-flex justify-content-between align-items-center">
        <div>
          <h4 class="mb-0">{{ customer.name }}</h4>
          <div class="small text-muted">{% trans "Phone:" %} {{ customer.phone }} &nbsp; | &nbsp; {% trans "Email:" %} {{ customer.email }}</div>
        </div>
        <div>
          <a href="/customers/{{ customer.id }}/edit" class="btn btn-sm btn-outline-primary">{% trans "Edit Customer" %}</a>
          <a href="/customers" class="btn btn-sm btn-outline-secondary">{% trans "Back to list" %}</a>
        </div>
      </div>
      <div class="card-body">
        <h5>{% trans "Sales Orders for this customer" %}</h5>
        {% if sales %}
        <div class="table-responsive">
          <table class="table table-hover table-bordered align-middle">
            <thead class="table-dark">
              <tr>
                <th>{% trans "No." %}</th>
                <th>{% trans "Order Type" %}</th>
                <th>{% trans "Added by" %}</th>
                <th>{% trans "Date" %}</th>
                <th>{% trans "Total" %}</th>
                <th>{% trans "Action" %}</th>
              </tr>
            </thead>
            <tbody>
              {% for order in sales %}
              <tr>
                <td>{{ order.id }}</td>
                <td>{% trans "Sale Order" %}</td>
                <td>{{ order.employee.first_name }} {{ order.employee.last_name }}</td>
                <td>{{ order.created_at }}</td>
                <td>{{ order.total_amount }}</td>
                <td>
                  <a class="btn btn-sm btn-outline-primary" href="/view_sale_order/{{ order.id }}">{% trans "View" %}</a>
                </td>
              </tr>
              {% endfor %}
              {% for voucher in stock_outs %}
              <tr>
                <td>{{ voucher.id }}</td>
                <td>{% trans "Stock Out Order" %}</td>
                <td>{{ voucher.employee.first_name }} {{ voucher.employee.last_name }}</td>
                <td>{{ voucher.created_at }}</td>
                <td>{{ voucher.total_amount }}</td>
                <td>
                  <a class="btn btn-sm btn-outline-primary" href="/view_stock_out_invoice/{{ voucher.id }}">{% trans "View" %}</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        {% if sales.has_other_pages %}
        <nav aria-label="Sales pagination" class="mt-3">
          <ul class="pagination justify-content-center">
            {% if sales.has_previous %}
              <li class="page-item"><a class="page-link" href="?page={{ sales.previous_page_number }}">&laquo;</a></li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">&laquo;</span></li>
            {% endif %}
            {% for num in sales.paginator.page_range %}
              {% if sales.number == num %}
                <li class="page-item active"><span class="page-link">{{ num }}</span></li>
              {% else %}
                <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
              {% endif %}
            {% endfor %}
            {% if sales.has_next %}
              <li class="page-item"><a class="page-link" href="?page={{ sales.next_page_number }}">&raquo;</a></li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">&raquo;</span></li>
            {% endif %}
          </ul>
        </nav>
        {% endif %}

        {% else %}
          <div class="alert alert-info">{% trans "No sales orders found for this customer." %}</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

{% endblock content %}
