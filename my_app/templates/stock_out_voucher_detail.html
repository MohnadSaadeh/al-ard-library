{% extends 'layouts/base.html' %}
{% load i18n %}

{% block title %}{% trans "Stock Out Voucher" %} #{{ voucher.id }}{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="card shadow-sm">
    <div class="card-header">
      <h4 class="mb-0">{% trans "Stock Out Voucher" %} #{{ voucher.id }}</h4>
      <div class="small text-muted">
        {% trans "Added by" %}: {{ voucher.employee.first_name }} {{ voucher.employee.last_name }}
        | {% trans "Added at" %}: {{ voucher.created_at }}
        | {% trans "Currency" %}: {{ voucher.currency.code|default:"-" }}
      </div>
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle">
          <thead class="table-light">
            <tr>
            <th> {% trans "ISBN" %} </th>
              <th>{% trans "Product" %}</th>
              <th>{% trans "Quantity" %}</th>
              <th>{% trans "Unit Price" %}</th>
              <th>{% trans "Total Price" %}</th>
              <!-- if the voucher currency is different from the base currency, show the converted total base -->
                {% if voucher.currency and voucher.exchange_rate_to_base != 1 %}
                    <th>{% trans "Total (Base)" %}</th>
                {% endif %}
            </tr>
          </thead>
          <tbody>
            {% for it in items %}
            <tr>
                <td>{{ it.product.isbn }}</td>
              <td>{{ it.product.product_name }}</td>
              <td>{{ it.quantity }}</td>
              <td>{{ it.unit_price }}</td>
              <td>{{ it.total_price }}</td>
              <!-- if the voucher currency is different from the base currency, show the converted total price -->
                {% if voucher.currency and voucher.exchange_rate_to_base != 1 %}
                    <td>{{ it.total_price_base }} {{ voucher.currency.code }}</td>
                {% endif %}
            </tr>
            {% endfor %}
            <tr class="table-secondary fw-bold">
              <td colspan="4" class="text-end">{% trans "Grand Total" %}</td>
              <td>{{ voucher.grand_total }} {{company.base_currency.code}}</td>
                <!-- if the voucher currency is different from the base currency, show the converted total -->
                {% if voucher.currency and voucher.exchange_rate_to_base != 1 %}
                    <td>{{ voucher.total_price_base }} {{ voucher.currency.code }}</td>
                {% endif %}
            </tr>
          </tbody>
        </table>
      </div>
      <div class="mt-3">
        <a href="{% url 'display_Stock_Out_voucher' %}" class="btn btn-outline-secondary">{% trans "Back" %}</a>
        <a href="{% url 'stock_out_invoice_edit' voucher.id %}" class="btn btn-primary">{% trans "Edit" %}</a>
        <a href="{% url 'print_stock_out_voucher' voucher.id %}" class="btn btn-outline-primary" target="_blank">{% trans "Print" %}</a>
        <a href="{% url 'convert_stock_out_to_sale' voucher.id %}" class="btn btn-success" onclick="return confirm('{% trans "Are you sure you want to convert this voucher to a sale?" %}')">{% trans "Convert to Sale" %}</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
