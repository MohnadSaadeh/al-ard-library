{% extends 'layouts/base.html' %}
{% load i18n %}

{% block title %}{{ supplier.name }} - {% trans "Supplier" %}{% endblock %}

{% block content %}

{% block page_name %}{{ supplier.name }}{% endblock %}
{% block page_name2 %}{% trans "Supplier Details" %}{% endblock %}

<div class="row justify-content-center">
  <div class="col-lg-10 col-md-12">
    <div class="card mb-4">
      <div class="card-header d-flex justify-content-between align-items-center">
        <div>
          <h4 class="mb-0">{{ supplier.name }}</h4>
          <div class="small text-muted">{% trans "Phone:" %} {{ supplier.phone }} &nbsp; | &nbsp; {% trans "Email:" %} {{ supplier.email }}</div>
        </div>
        <div>
          <a href="/suppliers/{{ supplier.id }}/edit" class="btn btn-sm btn-outline-primary">{% trans "Edit Supplier" %}</a>
          <a href="/suppliers" class="btn btn-sm btn-outline-secondary">{% trans "Back to list" %}</a>
        </div>
      </div>
      <div class="card-body">
        <h5>{% trans "Purchase Invoices from this supplier" %}</h5>
        {% if purchases %}
        <div class="table-responsive">
          <table class="table table-hover table-bordered align-middle">
            <thead class="table-dark">
              <tr>
                <th>{% trans "Invoice No." %}</th>
                <th>{% trans "Added by" %}</th>
                <th>{% trans "Date" %}</th>
                <th>{% trans "Grand Total" %}</th>
                <th>{% trans "Action" %}</th>
              </tr>
            </thead>
            <tbody>
              {% for invoice in purchases %}
              <tr>
                <td>{{ invoice.id }}</td>
                <td>{{ invoice.employee.first_name }} {{ invoice.employee.last_name }}</td>
                <td>{{ invoice.created_at }}</td>
                <td>{{ invoice.grand_total }}</td>
                <td>
                  <a class="btn btn-sm btn-outline-primary" href="/view_purchase_invoice/{{ invoice.id }}">{% trans "View" %}</a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        {% if purchases.has_other_pages %}
        <nav aria-label="Purchases pagination" class="mt-3">
          <ul class="pagination justify-content-center">
            {% if purchases.has_previous %}
              <li class="page-item"><a class="page-link" href="?page={{ purchases.previous_page_number }}">&laquo;</a></li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">&laquo;</span></li>
            {% endif %}
            {% for num in purchases.paginator.page_range %}
              {% if purchases.number == num %}
                <li class="page-item active"><span class="page-link">{{ num }}</span></li>
              {% else %}
                <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
              {% endif %}
            {% endfor %}
            {% if purchases.has_next %}
              <li class="page-item"><a class="page-link" href="?page={{ purchases.next_page_number }}">&raquo;</a></li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">&raquo;</span></li>
            {% endif %}
          </ul>
        </nav>
        {% endif %}

        {% else %}
          <div class="alert alert-info">{% trans "No purchase invoices found for this supplier." %}</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

{% endblock content %}
